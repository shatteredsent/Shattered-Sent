<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shattered & Sent - Transformed by Grace, Empowered for Purpose</title>
    <meta name="description" content="Christian ministry sharing stories of redemption, healing, and God's grace. Biblical insights, testimonies, and practical wisdom for your spiritual journey.">
    <meta name="keywords" content="Christian ministry, faith, redemption, Bible study, testimonies, spiritual growth">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#2A4D69',
                        'primary-dark': '#1E364A',
                        'secondary': '#4B8CC8',
                        'accent': '#F7B32B',
                        'text-primary': '#2C3E50',
                        'text-secondary': '#6E8898',
                        'background': '#ECF0F1',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'oswald': ['Oswald', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'spin': 'spin 1s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px) rotate(0deg)' },
                            '50%': { transform: 'translateY(-10px) rotate(1deg)' },
                        }
                    },
                    backdropBlur: {
                        'xl': '20px',
                    }
                }
            }
        }
    </script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .heading-font {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .hero-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(75, 140, 200, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(42, 77, 105, 0.2) 0%, transparent 50%);
            animation: float 6s ease-in-out infinite;
        }
        
        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(42, 77, 105, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .content-card:hover::before {
            left: 100%;
        }
        
        .btn-shine::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-shine:hover::before {
            left: 100%;
        }
        
        .youtube-embed {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
        }
        
        .youtube-embed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #2A4D69, #4B8CC8);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-100 to-blue-50 text-slate-800 leading-relaxed">
    <!-- Notification Container -->
    <div id="notification" class="fixed top-5 right-5 p-4 px-6 rounded-xl text-white font-semibold z-50 transform translate-x-full transition-transform duration-300 shadow-2xl max-w-sm">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="notification-text"></span>
        </div>
    </div>

    <!-- Header -->
    <header class="glass-effect sticky top-0 z-40 py-4 px-6">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center space-x-3 mb-4 md:mb-0">
                <img src="Shattered.png" 
                     alt="Shattered & Sent Logo" 
                     class="h-16 w-auto mr-3 rounded-lg shadow-md"
                     onerror="this.onerror=null;this.src='https://placehold.co/64x64/E0E0E0/888888?text=Logo';">
                <div>
                    <div class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent heading-font">Shattered & Sent</div>
                    <div class="text-sm text-gray-500 hidden md:block">From Brokenness to Bold Faith</div>
                </div>
            </div>
            <nav>
                <ul class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-8">
                    <li><a href="#home" class="nav-link relative text-text-secondary hover:text-primary font-medium py-2 transition-colors duration-300">Home</a></li>
                    <li><a href="#about" class="nav-link relative text-text-secondary hover:text-primary font-medium py-2 transition-colors duration-300">About</a></li>
                    <li><a href="#content" class="nav-link relative text-text-secondary hover:text-primary font-medium py-2 transition-colors duration-300">Content</a></li>
                    <li><a href="#contact" class="nav-link relative text-text-secondary hover:text-primary font-medium py-2 transition-colors duration-300">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="bg-gradient-to-br from-primary-dark via-primary to-secondary text-white py-20 px-6 relative overflow-hidden hero-overlay">
        <div class="max-w-7xl mx-auto relative z-10">
            <div class="text-center max-w-5xl mx-auto">
                <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold heading-font leading-tight mb-8">
                    Transformed by Grace,
                    <span class="block text-yellow-300 mt-2">Empowered for Purpose</span>
                </h1>
                <p class="text-xl md:text-2xl mb-12 opacity-90 leading-relaxed max-w-4xl mx-auto">
                    From brokenness to bold faith â€” sharing stories of redemption, healing, and God's transformative grace. 
                    Discover biblical insights, powerful testimonies, and practical wisdom for your spiritual journey.
                </p>
                <div class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-16">
                    <a href="#content" class="bg-gradient-to-r from-primary to-primary-dark text-white px-8 py-4 rounded-full font-semibold text-lg inline-flex items-center gap-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl relative overflow-hidden btn-shine">
                        <i class="fas fa-play-circle"></i>
                        Watch Latest Message
                    </a>
                    <a href="#about" class="bg-white/10 text-white border-2 border-white/30 px-8 py-4 rounded-full font-semibold text-lg inline-flex items-center gap-2 transition-all duration-300 hover:bg-white/20 hover:border-white/50 hover:-translate-y-1 backdrop-blur-sm">
                        <i class="fas fa-heart"></i>
                        Our Story
                    </a>
                </div>
                
                <!-- Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                    <div class="text-center p-8 bg-white/10 backdrop-blur-sm rounded-2xl border border-white/20 transition-all duration-300 hover:bg-white/20 hover:-translate-y-2">
                        <div class="text-5xl font-extrabold bg-gradient-to-b from-white to-blue-100 bg-clip-text text-transparent leading-none">500+</div>
                        <p class="text-white/80 font-medium text-lg mt-2">Lives Transformed</p>
                    </div>
                    <div class="text-center p-8 bg-white/10 backdrop-blur-sm rounded-2xl border border-white/20 transition-all duration-300 hover:bg-white/20 hover:-translate-y-2">
                        <div class="text-5xl font-extrabold bg-gradient-to-b from-white to-blue-100 bg-clip-text text-transparent leading-none">100+</div>
                        <p class="text-white/80 font-medium text-lg mt-2">Video Messages</p>
                    </div>
                    <div class="text-center p-8 bg-white/10 backdrop-blur-sm rounded-2xl border border-white/20 transition-all duration-300 hover:bg-white/20 hover:-translate-y-2">
                        <div class="text-5xl font-extrabold bg-gradient-to-b from-white to-blue-100 bg-clip-text text-transparent leading-none">50+</div>
                        <p class="text-white/80 font-medium text-lg mt-2">Countries Reached</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Latest Video Section -->
    <section id="content" class="py-20 px-6 bg-white">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent heading-font mb-6">Latest Message</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Watch our most recent inspiring message of hope, healing, and transformation
                </p>
                <div class="h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent mx-auto mt-12 max-w-xs"></div>
            </div>
            
            <div id="youtube-container" class="max-w-5xl mx-auto">
                <div id="youtube-loading" class="flex justify-center items-center py-20 glass-effect rounded-3xl">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
                    <span class="ml-3 text-gray-600 text-lg">Loading latest message...</span>
                </div>
                <div id="youtube-video" class="youtube-embed hidden rounded-2xl overflow-hidden shadow-2xl"></div>
                <div id="youtube-error" class="text-center py-16 glass-effect rounded-3xl hidden">
                    <i class="fas fa-exclamation-triangle text-orange-500 text-4xl mb-6"></i>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">Unable to Load Video</h3>
                    <p class="text-gray-600 text-lg mb-4"></p>
                    <a href="https://www.youtube.com/@shatteredsent" target="_blank" class="bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-3 rounded-full font-semibold inline-flex items-center gap-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl">
                        <i class="fab fa-youtube mr-2"></i>
                        Visit Our YouTube Channel
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Study Guide Section -->
    <section class="py-20 px-6 relative bg-cover bg-center bg-fixed" style="background-image: url('Shattered Thumbnail.jpg');">
        <!-- Overlay for readability -->
        <div class="absolute inset-0 bg-black/50"></div>
        <div class="max-w-7xl mx-auto relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold heading-font mb-6 text-white">Featured Study Guide</h2>
                <p class="text-xl max-w-3xl mx-auto text-white">
                    Download our comprehensive curriculum for overcoming adversity through biblical wisdom
                </p>
                <div class="h-0.5 bg-gradient-to-r from-transparent via-white to-transparent mx-auto mt-12 max-w-xs"></div>
            </div>
            
            <!-- Main Study Guide Card -->
            <div class="max-w-5xl mx-auto mb-16">
                <div class="content-card bg-gradient-to-br from-white/90 to-blue-50/90 rounded-xl overflow-hidden relative transition-all duration-500 hover:-translate-y-3 hover:scale-105 hover:shadow-2xl">
                    <div class="grid lg:grid-cols-2 gap-0">
                        <div class="relative rounded-xl overflow-hidden group">
                            <img src="https://placehold.co/600x400/D1D5DB/1F2937?text=Study+Guide+Image" 
                                 onerror="this.onerror=null;this.src='https://placehold.co/600x400/D1D5DB/1F2937?text=Image+Not+Found';"
                                 alt="Overcoming Adversity Study Guide" 
                                 class="w-full h-full object-cover min-h-[300px] transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-r from-primary-dark/80 to-primary/80 flex items-center justify-center">
                                <div class="text-center text-white p-8">
                                    <i class="fas fa-book-open text-6xl mb-4 opacity-90"></i>
                                    <h3 class="text-3xl font-bold heading-font">7-Session Study</h3>
                                    <p class="text-xl opacity-90">Downloadable PDF Guide</p>
                                </div>
                            </div>
                        </div>
                        <div class="p-8 lg:p-12">
                            <div class="flex items-center mb-4">
                                <span class="bg-gradient-to-r from-accent to-yellow-600 text-white px-4 py-2 rounded-full text-sm font-semibold shadow-lg mr-4">New Release</span>
                                <span class="text-gray-500 text-sm">âœ¨ Free Download</span>
                            </div>
                            <h3 class="text-3xl font-bold text-gray-800 heading-font mb-6">Overcoming Adversity</h3>
                            <p class="text-gray-600 mb-6 leading-relaxed text-lg">
                                A comprehensive 7-session curriculum designed to help believers move from brokenness to bold faith. Perfect for personal study, small groups, or church ministries.
                            </p>
                            
                            <!-- Study Guide Features -->
                            <div class="space-y-3 mb-8">
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                    <span>7 in-depth sessions with Scripture foundations</span>
                                </div>
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                    <span>Discussion questions for group study</span>
                                </div>
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                    <span>Practical exercises and applications</span>
                                </div>
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                    <span>Journaling prompts and reflection activities</span>
                                </div>
                            </div>
                            
                            <div class="flex flex-col sm:flex-row gap-4">
                                <button id="download-guide-btn" class="bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-3 rounded-full font-semibold text-lg flex-1 inline-flex items-center justify-center gap-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl relative overflow-hidden btn-shine">
                                    <i class="fas fa-download mr-2"></i>
                                    Download Free Guide
                                </button>
                                <button id="preview-guide-btn" class="bg-gray-100 text-gray-700 border border-gray-300 px-6 py-3 rounded-full font-semibold text-lg hover:bg-gray-200 transition-all duration-300 inline-flex items-center justify-center gap-2">
                                    <i class="fas fa-eye mr-2"></i>
                                    Preview
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Content Grid (Blog Posts) -->
    <section class="py-20 px-6 bg-gray-50">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 id="blog-title" class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent heading-font mb-6">More Resources</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Explore our collection of biblical insights, practical teachings, and inspiring testimonies
                </p>
                <div class="h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent mx-auto mt-12 max-w-xs"></div>
            </div>
            
            <div id="blog-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Blog posts will be loaded here dynamically by JavaScript -->
                <!-- Placeholder cards for loading state -->
                <div class="content-card bg-gradient-to-br from-white to-gray-50 rounded-xl overflow-hidden border border-gray-200 relative transition-all duration-500 hover:-translate-y-3 hover:scale-105 hover:shadow-2xl">
                    <div class="p-6">
                        <div class="animate-pulse">
                            <div class="h-4 bg-gray-300 rounded w-3/4 mb-3"></div>
                            <div class="h-3 bg-gray-300 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-300 rounded w-5/6"></div>
                        </div>
                    </div>
                </div>
                <div class="content-card bg-gradient-to-br from-white to-gray-50 rounded-xl overflow-hidden border border-gray-200 relative transition-all duration-500 hover:-translate-y-3 hover:scale-105 hover:shadow-2xl">
                    <div class="p-6">
                        <div class="animate-pulse">
                            <div class="h-4 bg-gray-300 rounded w-3/4 mb-3"></div>
                            <div class="h-3 bg-gray-300 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-300 rounded w-5/6"></div>
                        </div>
                    </div>
                </div>
                <div class="content-card bg-gradient-to-br from-white to-gray-50 rounded-xl overflow-hidden border border-gray-200 relative transition-all duration-500 hover:-translate-y-3 hover:scale-105 hover:shadow-2xl">
                    <div class="p-6">
                        <div class="animate-pulse">
                            <div class="h-4 bg-gray-300 rounded w-3/4 mb-3"></div>
                            <div class="h-3 bg-gray-300 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-300 rounded w-5/6"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-20 px-6 bg-white">
        <div class="max-w-7xl mx-auto text-center">
            <h2 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent heading-font mb-6">About Shattered & Sent</h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-6 leading-relaxed">
                "Shattered & Sent" is a ministry dedicated to sharing the transformative power of God's love and grace. Even in brokenness, God uses us for His glorious purposes. We provide biblical insights, testimonies, and practical wisdom to encourage believers on their spiritual journey.
            </p>
            <div class="h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent mx-auto mt-12 max-w-xs"></div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 px-6 bg-gradient-to-br from-background to-blue-50">
        <div class="max-w-4xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent heading-font mb-6">Get in Touch</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    We'd love to hear from you. Send us a message or connect via email.
                </p>
                <div class="h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent mx-auto mt-12 max-w-xs"></div>
            </div>
            
            <div class="max-w-2xl mx-auto glass-effect p-8 rounded-xl shadow-lg">
                <form id="contact-form" class="space-y-6">
                    <div>
                        <label for="name" class="block text-lg font-medium text-gray-700 mb-2">Name</label>
                        <input type="text" id="name" name="name" required class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white" placeholder="Your Name">
                    </div>
                    <div>
                        <label for="email" class="block text-lg font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="email" name="email" required class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white" placeholder="you@example.com">
                    </div>
                    <div>
                        <label for="message" class="block text-lg font-medium text-gray-700 mb-2">Message</label>
                        <textarea id="message" name="message" rows="6" required class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white" placeholder="Your message..."></textarea>
                    </div>
                    <div class="text-center">
                        <button type="submit" id="submit-btn" class="bg-gradient-to-r from-primary to-primary-dark text-white px-10 py-4 rounded-full font-semibold text-lg shadow-xl transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl disabled:opacity-50 relative overflow-hidden btn-shine">
                            <span id="submit-text">Send Message</span>
                            <div id="submit-spinner" class="animate-spin rounded-full h-5 w-5 border-b-2 border-white mx-auto hidden"></div>
                        </button>
                    </div>
                </form>
                
                <div class="mt-12 text-center text-gray-600">
                    <p class="mb-2">Or email us directly at:</p>
                    <p class="text-xl font-semibold text-primary">
                        <a href="mailto:shattered.sent@gmail.com" class="hover:underline">shattered.sent@gmail.com</a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 px-6 text-center">
        <div class="max-w-7xl mx-auto">
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8 mb-6">
                <a href="https://www.youtube.com/@shatteredsent" target="_blank" class="text-white/80 hover:text-white transition duration-300">
                    <i class="fab fa-youtube text-2xl"></i>
                </a>
                <a href="mailto:shattered.sent@gmail.com" class="text-white/80 hover:text-white transition duration-300">
                    <i class="fas fa-envelope text-2xl"></i>
                </a>
            </div>
            <p class="text-gray-400 text-sm">&copy; 2025 Shattered & Sent. All rights reserved.</p>
        </div>
    </footer>

    <!-- Modals remain the same... -->
    <!-- Generic Blog Post Modal -->
    <div id="blog-post-modal" class="hidden fixed inset-0 bg-black/75 z-50 flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
            <div class="p-6 border-b border-gray-200 flex justify-between items-start">
                <div>
                    <h2 id="blog-modal-title" class="text-2xl md:text-3xl font-bold text-gray-800 mb-2"></h2>
                    <div id="blog-modal-meta" class="text-sm text-gray-500"></div>
                </div>
                <button class="js-close-modal text-gray-500 hover:text-gray-700 text-3xl ml-4 flex-shrink-0" aria-label="Close modal">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[70vh]">
                <div id="blog-modal-content" class="prose prose-lg max-w-none text-gray-900 leading-relaxed">
                    <!-- Content will be injected here -->
                </div>
            </div>
            <div class="p-6 border-t border-gray-200 bg-gray-50 text-center">
                <button class="js-close-modal bg-primary text-white px-6 py-2 rounded-full hover:bg-primary-dark transition duration-300 shadow-md">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Study Guide Download Modal -->
    <div id="study-guide-modal" class="hidden fixed inset-0 bg-black/75 z-50 flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-hidden shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
            <div class="p-6 border-b border-gray-200 flex justify-between items-start">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Download Study Guide</h2>
                    <p class="text-gray-600">Fill in your details to get your free guide.</p>
                </div>
                <button class="js-close-modal text-gray-500 hover:text-gray-700 text-3xl ml-4 flex-shrink-0" aria-label="Close modal">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[70vh]">
                <form id="download-form" class="space-y-6">
                    <div>
                        <label for="download-name" class="block text-lg font-medium text-gray-700 mb-2">Name</label>
                        <input type="text" id="download-name" name="name" required class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white" placeholder="Your Name">
                    </div>
                    <div>
                        <label for="download-email" class="block text-lg font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="download-email" name="email" required class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white" placeholder="your.email@example.com">
                    </div>
                    <div>
                        <label for="intended_use" class="block text-lg font-medium text-gray-700 mb-2">How do you intend to use this guide?</label>
                        <select id="intended_use" name="intended_use" class="w-full p-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white">
                            <option value="personal">Personal Study</option>
                            <option value="small_group">Small Group</option>
                            <option value="church_ministry">Church Ministry</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="newsletter" name="newsletter" class="h-5 w-5 text-primary focus:ring-primary border-gray-300 rounded">
                        <label for="newsletter" class="ml-2 block text-gray-700">Subscribe to our newsletter for more resources and updates.</label>
                    </div>
                    <div class="text-center">
                        <button type="button" id="download-study-guide-submit" class="bg-gradient-to-r from-primary to-primary-dark text-white px-10 py-4 rounded-full font-semibold text-lg shadow-xl transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl">
                            Download Now
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Study Guide Preview Modal -->
    <div id="preview-modal" class="hidden fixed inset-0 bg-black/75 z-50 flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
            <div class="p-6 border-b border-gray-200 flex justify-between items-start">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Study Guide Preview</h2>
                    <p class="text-gray-600">A glimpse into the "Overcoming Adversity" curriculum.</p>
                </div>
                <button class="js-close-modal text-gray-500 hover:text-gray-700 text-3xl ml-4 flex-shrink-0" aria-label="Close preview">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[70vh]">
                <div id="preview-content" class="prose prose-lg max-w-none text-gray-900 leading-relaxed">
                    <!-- Study guide content will be loaded here -->
                </div>
            </div>
            <div class="p-6 border-t border-gray-200 bg-gray-50 text-center">
                <button class="js-close-modal bg-primary text-white px-6 py-2 rounded-full hover:bg-primary-dark transition duration-300 shadow-md">
                    Close Preview
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuration - Update this to match your deployed backend URL
        const API_BASE_URL = 'https://jshafer2017.pythonanywhere.com';

        // Show notifications
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            const notificationIcon = notification.querySelector('i');

            notificationText.textContent = message;
            
            // Remove existing classes and add new ones
            notification.className = `fixed top-5 right-5 p-4 px-6 rounded-xl text-white font-semibold z-50 transform transition-transform duration-300 shadow-2xl max-w-sm`;
            
            if (type === 'success') {
                notification.classList.add('bg-gradient-to-r', 'from-green-500', 'to-green-600');
                notificationIcon.className = 'fas fa-check-circle mr-2';
            } else if (type === 'error') {
                notification.classList.add('bg-gradient-to-r', 'from-red-500', 'to-red-600');
                notificationIcon.className = 'fas fa-times-circle mr-2';
            }
            
            notification.classList.remove('translate-x-full');

            setTimeout(() => {
                notification.classList.add('translate-x-full');
            }, 4000);
        }

        // Load latest YouTube video
        async function loadLatestVideo() {
            const loadingEl = document.getElementById('youtube-loading');
            const videoEl = document.getElementById('youtube-video');
            const errorEl = document.getElementById('youtube-error');
            const errorMessageEl = errorEl.querySelector('p');

            try {
                const response = await fetch(`${API_BASE_URL}/api/latest-video`);
                const data = await response.json();

                if (response.ok && data.videoId) {
                    loadingEl.classList.add('hidden');
                    videoEl.innerHTML = `
                        <iframe 
                            src="https://www.youtube.com/embed/${data.videoId}" 
                            title="Latest Video" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    `;
                    videoEl.classList.remove('hidden');
                } else {
                    throw new Error(data.error || 'Failed to load video');
                }
            } catch (error) {
                console.error('Error loading video:', error);
                loadingEl.classList.add('hidden');
                if (errorMessageEl) {
                    errorMessageEl.textContent = `We encountered an issue loading the video. Error: ${error.message}`;
                }
                errorEl.classList.remove('hidden');
            }
        }

        // Load blog posts
        async function loadBlogPosts() {
            const blogContainer = document.getElementById('blog-container');
            const blogTitle = document.getElementById('blog-title'); 
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/blog-posts`);
                const data = await response.json();

                if (response.ok && data.posts && data.posts.length > 0) {
                    // Store posts globally for modal access
                    window.blogPosts = data.posts;
                    
                    if (blogTitle) {
                        blogTitle.textContent = 'Latest Blog Posts';
                    }
                    
                    blogContainer.innerHTML = data.posts.slice(0, 3).map((post, index) => {
                        const publishDate = new Date(post.publish_date).toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                        
                        return `
                            <div class="content-card bg-gradient-to-br from-white to-gray-50 rounded-xl overflow-hidden border border-gray-200 relative transition-all duration-500 hover:-translate-y-3 hover:scale-105 hover:shadow-2xl cursor-pointer flex flex-col" data-post-index="${index}">
                                <div class="p-6 flex-grow">
                                    <h3 class="text-2xl font-bold heading-font mb-4 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">${post.title}</h3>
                                    <p class="text-gray-600 mb-4 leading-relaxed">${post.excerpt}</p>
                                </div>
                                <div class="p-6 bg-gray-50 border-t border-gray-200">
                                    <div class="flex justify-between items-center text-sm text-gray-500">
                                        <span>By ${post.author}</span>
                                        <span>${publishDate}</span>
                                    </div>
                                    <div class="mt-4 font-semibold text-primary">Read More &rarr;</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    blogContainer.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <p class="text-gray-600">Unable to load blog posts at this time.</p>
                            <p class="text-gray-500 text-sm mt-2">Please check back later.</p>
                            <p class="text-red-500 text-sm mt-1">Error: ${data.error || 'No posts or API error.'}</p>
                        </div>
                    `;
                    throw new Error(data.error || 'No blog posts found or API error.');
                }
            } catch (error) {
                console.error('Error loading blog posts:', error);
                blogContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-600">Unable to load blog posts at this time.</p>
                        <p class="text-gray-500 text-sm mt-2">Please check back later.</p>
                        <p class="text-red-500 text-sm mt-1">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Open blog post in modal
        function openBlogPost(index) {
            const post = window.blogPosts[index];
            if (!post) return;

            const publishDate = new Date(post.publish_date).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Advanced content formatting to handle headings, paragraphs, lists, and blockquotes.
            const blocks = post.content.split(/\n\s*\n/).filter(block => block.trim() !== ''); // Split by blank lines
            let htmlContent = '';

            for (const block of blocks) {
                const trimmedBlock = block.trim();
                
                if (trimmedBlock.toLowerCase().startsWith('reflection questions:')) {
                    const lines = trimmedBlock.split('\n');
                    const heading = lines.shift(); // Get the "Reflection Questions:" line
                    htmlContent += `<h3 class="text-xl font-semibold mt-8 mb-4">${heading}</h3>`;
                    htmlContent += '<ul class="list-disc list-inside space-y-2 mb-4">';
                    for (const line of lines) {
                        if (line.trim()) {
                            htmlContent += `<li>${line.trim()}</li>`;
                        }
                    }
                    htmlContent += '</ul>';
                } else if (/^\d+\.\s/.test(trimmedBlock) || /conclusion:/i.test(trimmedBlock) || /introduction:/i.test(trimmedBlock)) {
                    // This is a main heading
                    htmlContent += `<h3 class="text-2xl font-bold heading-font mt-8 mb-4">${trimmedBlock}</h3>`;
                } else if (trimmedBlock.startsWith('â€”')) {
                    // This is a blockquote for scripture reference
                    htmlContent += `<blockquote class="border-l-4 border-gray-400 pl-4 italic my-6 text-gray-700">${trimmedBlock}</blockquote>`;
                } else if (trimmedBlock.toLowerCase().startsWith('scripture focus:')) {
                    htmlContent += `<p class="font-semibold text-lg text-gray-800 my-4">${trimmedBlock}</p>`;
                } else {
                    // Default to a paragraph.
                    const paragraph = trimmedBlock.replace(/\n/g, ' ');
                    htmlContent += `<p class="my-4">${paragraph}</p>`;
                }
            }

            // Populate the modal
            document.getElementById('blog-modal-title').textContent = post.title;
            document.getElementById('blog-modal-meta').innerHTML = `By ${post.author} &bull; ${publishDate}`;
            document.getElementById('blog-modal-content').innerHTML = htmlContent;

            // Show the modal
            const modal = document.getElementById('blog-post-modal');
            const innerModal = modal.querySelector('div:first-child');
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.classList.add('opacity-100');
                innerModal.classList.remove('scale-95', 'opacity-0');
                innerModal.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Close blog modal
        function closeBlogModal() {
            const modal = document.getElementById('blog-post-modal');
            if (modal) {
                const innerModal = modal.querySelector('div:first-child');
                
                modal.classList.remove('opacity-100');
                modal.classList.add('opacity-0');
                innerModal.classList.remove('scale-100', 'opacity-100');
                innerModal.classList.add('scale-95', 'opacity-0');

                setTimeout(() => {
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }, 300);
            }
        }

        // Study Guide Modal Functions
        function openStudyGuideModal() {
            const modal = document.getElementById('study-guide-modal');
            const innerModal = modal.querySelector('div:first-child');

            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.classList.add('opacity-100');
                innerModal.classList.remove('scale-95', 'opacity-0');
                innerModal.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeStudyGuideModal() {
            const modal = document.getElementById('study-guide-modal');
            if (modal) {
                const innerModal = modal.querySelector('div:first-child');
                
                modal.classList.remove('opacity-100');
                modal.classList.add('opacity-0');
                innerModal.classList.remove('scale-100', 'opacity-100');
                innerModal.classList.add('scale-95', 'opacity-0');

                setTimeout(() => {
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }, 300);
            }
        }

        function showStudyGuidePreview() {
            const previewContentEl = document.getElementById('preview-content');
            previewContentEl.innerHTML = generateStudyGuideContentForPreview(); 

            const modal = document.getElementById('preview-modal');
            const innerModal = modal.querySelector('div:first-child');

            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.classList.add('opacity-100');
                innerModal.classList.remove('scale-95', 'opacity-0');
                innerModal.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closePreviewModal() {
            const modal = document.getElementById('preview-modal');
            if (modal) {
                const innerModal = modal.querySelector('div:first-child');
                
                modal.classList.remove('opacity-100');
                modal.classList.add('opacity-0');
                innerModal.classList.remove('scale-100', 'opacity-100');
                innerModal.classList.add('scale-95', 'opacity-0');

                setTimeout(() => {
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }, 300);
            }
        }

        // Handle study guide download
        async function handleStudyGuideDownload() {
            const form = document.getElementById('download-form');
            const downloadNameInput = document.getElementById('download-name');
            const downloadEmailInput = document.getElementById('download-email');

            const data = {
                name: downloadNameInput.value.trim(),
                email: downloadEmailInput.value.trim(),
                intended_use: form.elements['intended_use'].value || 'not specified',
                newsletter: form.elements['newsletter'].checked
            };

            if (!data.name || !data.email) {
                showNotification('Please fill in your name and email address.', 'error');
                return;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(data.email)) {
                showNotification('Please enter a valid email address.', 'error');
                return;
            }

            try {
                showNotification('Preparing your download...', 'success');
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                downloadStudyGuideHtml(data.name);
                closeStudyGuideModal();
                showNotification('Study guide downloaded successfully! Check your downloads folder.', 'success');
                form.reset();
                
            } catch (error) {
                console.error('Error downloading study guide:', error);
                showNotification('Failed to download study guide. Please try again.', 'error');
            }
        }

        function generateStudyGuideContentForPreview() {
            const userName = document.getElementById('download-name')?.value || 'Guest';

            return `
                <h1 class="text-3xl font-bold mb-4">Overcoming Adversity: A 7-Session Study Guide</h1>
                <h2 class="text-xl font-semibold mb-6">Shattered & Sent Ministry</h2>

                <p class="mb-2"><em>Downloaded by: ${userName}</em></p>
                <p class="mb-6"><em>Date: ${new Date().toLocaleDateString()}</em></p>

                <hr class="my-8 border-gray-300">

                <h2 class="text-2xl font-bold mb-3">Session 1: Understanding Adversity â€” God's Classroom for Growth</h2>
                <p class="font-semibold text-lg mb-2">Scripture Foundation: Romans 5:3â€“5; James 1:2â€“4</p>
                <p class="font-semibold text-lg mb-4">Key Teaching: Adversity is not meaninglessâ€”it is a classroom where God develops perseverance, character, and hope.</p>
                <h3 class="text-xl font-semibold mb-2">Teaching Points:</h3>
                <ol class="list-decimal list-inside ml-4 space-y-1">
                    <li>Adversity comes in many forms (loss, sin, failure, injustice, hardship).</li>
                    <li>God does not waste suffering; He uses it to shape us into Christlikeness.</li>
                    <li>Trials invite us to trust God more deeply.</li>
                </ol>
                <h3 class="text-xl font-semibold mt-6 mb-2">Discussion Questions:</h3>
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li>When you face adversity, what is your first reaction?</li>
                    <li>How have past trials shaped your faith?</li>
                    <li>What do you think it means that suffering produces hope?</li>
                </ul>
                <p class="font-semibold italic mt-6">Application Challenge: Journal one trial you are currently experiencing. Write down what God may be teaching you through it.</p>

                <hr class="my-8 border-gray-300">

                <h2 class="text-2xl font-bold mb-3">Session 2: Cultivating a Growth Mindset Rooted in God's Promises</h2>
                <p class="font-semibold text-lg mb-2">Scripture Foundation: Philippians 4:8; Hebrews 13:5</p>
                <p class="font-semibold text-lg mb-4">Key Teaching: Faith reframes challenges, turning obstacles into opportunities for growth.</p>
                <h3 class="text-xl font-semibold mb-2">Teaching Points:</h3>
                <ol class="list-decimal list-inside ml-4 space-y-1">
                    <li>A growth mindset believes hardship is an opportunity to mature.</li>
                    <li>God's promises remind us we are not abandoned in adversity.</li>
                    <li>Replacing negative self-talk with biblical truth renews our minds.</li>
                </ol>
                <h3 class="text-xl font-semibold mt-6 mb-2">Discussion Questions:</h3>
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li>What lies do you tend to believe in hardship?</li>
                    <li>What promises from Scripture combat those lies?</li>
                    <li>How does focusing on "whatever is true, noble, right, pure" (Philippians 4:8) change perspective?</li>
                </ul>
                <p class="font-semibold italic mt-6">Practical Exercise: Write down one negative thought you often struggle with. Next to it, write the scriptural truth that replaces it.</p>

                <hr class="my-8 border-gray-300">

                <p class="font-bold mt-8 text-center text-lg">This study guide is a gift from Shattered & Sent Ministry.</p>
                <p class="text-center">For more resources, visit us online or contact us at shattered.sent@gmail.com</p>
                <p class="text-center font-bold italic mt-4">"We know that in all things God works for the good of those who love him, who have been called according to his purpose." - Romans 8:28</p>
            `;
        }

        function downloadStudyGuideHtml(userName) {
            const studyGuideContent = generateStudyGuideContentForPreview();
            const blob = new Blob([studyGuideContent], { type: 'text/html;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Overcoming-Adversity-Study-Guide-Shattered-and-Sent.html';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }

        // Handle contact form submission
        async function handleContactForm(event) {
            event.preventDefault();

            const form = document.getElementById('contact-form');
            const submitBtn = document.getElementById('submit-btn');
            const submitText = document.getElementById('submit-text');
            const submitSpinner = document.getElementById('submit-spinner');

            const formData = new FormData(form);
            const data = {
                name: formData.get('name').trim(),
                email: formData.get('email').trim(),
                message: formData.get('message').trim()
            };

            if (!data.name || !data.email || !data.message) {
                showNotification('Please fill in all fields.', 'error');
                return;
            }

            submitBtn.disabled = true;
            submitText.classList.add('hidden');
            submitSpinner.classList.remove('hidden');

            try {
                const response = await fetch(`${API_BASE_URL}/api/contact`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (response.ok) {
                    showNotification('Message sent successfully!', 'success');
                    form.reset();
                } else {
                    throw new Error(result.error || 'Failed to send message');
                }
            } catch (error) {
                console.error('Error sending message:', error);
                showNotification('Failed to send message. Please try again.', 'error');
            } finally {
                submitBtn.disabled = false;
                submitText.classList.remove('hidden');
                submitSpinner.classList.add('hidden');
            }
        }

        // Smooth scrolling for navigation
        function initSmoothScrolling() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            // Load dynamic content
            loadLatestVideo();
            loadBlogPosts();
            
            // Initialize smooth scrolling
            initSmoothScrolling();

            // Attach event listeners
            document.getElementById('contact-form').addEventListener('submit', handleContactForm);
            document.getElementById('download-guide-btn').addEventListener('click', openStudyGuideModal);
            document.getElementById('preview-guide-btn').addEventListener('click', showStudyGuidePreview);
            document.getElementById('download-study-guide-submit').addEventListener('click', handleStudyGuideDownload);

            // Event delegation for blog post clicks
            document.getElementById('blog-container').addEventListener('click', (event) => {
                const blogCard = event.target.closest('[data-post-index]');
                if (blogCard) {
                    const index = blogCard.dataset.postIndex;
                    openBlogPost(index);
                }
            });

            // Event delegation for closing modals
            document.body.addEventListener('click', (event) => {
                // Close by clicking the 'x' or a close button
                if (event.target.matches('.js-close-modal')) {
                    const modal = event.target.closest('.modal-overlay') || event.target.closest('[id$="-modal"]');
                    if (modal) {
                        if (modal.id === 'blog-post-modal') closeBlogModal();
                        if (modal.id === 'study-guide-modal') closeStudyGuideModal();
                        if (modal.id === 'preview-modal') closePreviewModal();
                    }
                }
                // Close by clicking the overlay
                if (event.target.matches('[id$="-modal"]')) {
                    if (event.target.id === 'blog-post-modal') closeBlogModal();
                    if (event.target.id === 'study-guide-modal') closeStudyGuideModal();
                    if (event.target.id === 'preview-modal') closePreviewModal();
                }
            });

            // Close modals with Escape key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    if (!document.getElementById('blog-post-modal').classList.contains('hidden')) closeBlogModal();
                    if (!document.getElementById('study-guide-modal').classList.contains('hidden')) closeStudyGuideModal();
                    if (!document.getElementById('preview-modal').classList.contains('hidden')) closePreviewModal();
                }
            });
        });
    </script>
</body>
</html>
